
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <title>8.1. 互质对：仪仗队（洛谷P2158，SDOI2008） &#8212; C++算法编程指南 0.1 文档</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/translations.js"></script>
    <script async="async" src="https://cdn.bootcss.com/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="prev" title="8. 竞赛题精选精讲" href="../700_problems.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../700_problems.html" title="8. 竞赛题精选精讲"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C++算法编程指南 0.1 文档</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../700_problems.html" accesskey="U"><span class="section-number">8. </span>竞赛题精选精讲</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>上一个主题</h4>
  <p class="topless"><a href="../700_problems.html"
                        title="上一章"><span class="section-number">8. </span>竞赛题精选精讲</a></p>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/ch07/701_p2158.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="p2158-sdoi2008">
<span id="index-0"></span><h1><span class="section-number">8.1. </span>互质对：仪仗队（洛谷P2158，SDOI2008）<a class="headerlink" href="#p2158-sdoi2008" title="永久链接至标题">¶</a></h1>
<p><strong>题目描述</strong></p>
<p>作为体育委员，C君负责这次运动会仪仗队的训练。仪仗队是由学生组成的 <span class="math notranslate nohighlight">\(N\times N\)</span> 的方阵，为了保证队伍在行进中整齐划一，C君会跟在仪仗队的左后方，根据其视线所及的学生人数来判断队伍是否整齐(如下图)。</p>
<img alt="../_images/701_p2158_pro.png" src="../_images/701_p2158_pro.png" />
<p>现在，C君希望你告诉他队伍整齐时能看到的学生人数。</p>
<p><strong>输入格式</strong></p>
<p>共一个数 <span class="math notranslate nohighlight">\(N\)</span></p>
<p><strong>输出格式</strong></p>
<p>共一个数，即C君应看到的学生人数。</p>
<p><strong>输入输出样例</strong></p>
<p>输入：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
<p>输出：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
<p><strong>说明/提示</strong></p>
<p>【数据规模和约定】</p>
<p>对于 <span class="math notranslate nohighlight">\(100%\)</span> 的数据，<span class="math notranslate nohighlight">\(1 \le N \le 40000\)</span></p>
<p><strong>题意分析</strong></p>
<p>对示例图中建立坐标系，以C君所在位置为坐标原点 <span class="math notranslate nohighlight">\((0,0)\)</span>，其余每位学生所在位置的横纵坐标值都用自然数 <span class="math notranslate nohighlight">\(0,1,\dots,n-1\)</span> 依次表示，即所谓的格点位置。除C君以外，一共有 <span class="math notranslate nohighlight">\(N^2-1\)</span> 位同学。</p>
<p>第一步一定要先分析有没有需要特判的数据。题目给出的数据范围说明 <span class="math notranslate nohighlight">\(N\)</span> 有可能为1，这种情况下方阵只有C君一个人，所以可以特判掉，直接输出0，结束。</p>
<p>正常情况下，<span class="math notranslate nohighlight">\(N\gt1\)</span>。先排除一些特殊的视线。从原点出发的水平线和垂直线是最特殊的，显然在这两条直线上，C君只能看到两位同学 <span class="math notranslate nohighlight">\((1,0)\)</span> 和 <span class="math notranslate nohighlight">\((0,1)\)</span>，其他的都可以排除掉。这样就知道了C君应看到的人数至少有2人。要考虑的方阵缩小为从 <span class="math notranslate nohighlight">\((1,1)\)</span> 到 <span class="math notranslate nohighlight">\((n-1,n-1)\)</span> 的范围。</p>
<p>然后是左起第二列和倒数第二行，不难发现，这两条直线上的所有学生，C君都是看得见的，他们不会被任何人遮挡。所以C君应看到的人数右增加了 <span class="math notranslate nohighlight">\(2(n-1)-1=2n-3\)</span> 人，加上前面的2人就有了 <span class="math notranslate nohighlight">\(2n-1\)</span> 个确定一定以及肯定可以看到的人了。要考虑的方阵进一步缩小为从 <span class="math notranslate nohighlight">\((2,2)\)</span> 到 <span class="math notranslate nohighlight">\((n-1,n-1)\)</span> 的范围，共有 <span class="math notranslate nohighlight">\((n-2)^2\)</span> 个人。</p>
<p>下面的示意图用一个 <span class="math notranslate nohighlight">\(N=9\)</span> 的方阵展示了到目前为止的状态。红色的点为C君，绿色的点为已经确定可以看到的学生，浅灰色的点是已经确定不会被看到的学生，深灰色的点表示还需要进一步分析的部分。</p>
<img alt="../_images/701_p2158.001.png" src="../_images/701_p2158.001.png" />
<p>下面我们来分析一下剩余的学生怎样判断其是否可被C君看见。</p>
<p>从C君所在位置看去，在同一条视线上的学生只能看到第一个。视线是一条直线，从原点出发的直线可以用方程 <span class="math notranslate nohighlight">\(y=kx\)</span> 来表示，这里 <span class="math notranslate nohighlight">\(x\)</span> 和 <span class="math notranslate nohighlight">\(y\)</span> 都必须是整数。如果 <span class="math notranslate nohighlight">\(x\)</span> 和 <span class="math notranslate nohighlight">\(y\)</span> 有大于1的公因数 <span class="math notranslate nohighlight">\(q\)</span>，即 <span class="math notranslate nohighlight">\(x=qx^\prime,y=qy^\prime\)</span>，那么 <span class="math notranslate nohighlight">\(y=kx\implies y^\prime=kx^\prime\)</span>，意味着位置 <span class="math notranslate nohighlight">\((x^\prime,y^\prime)\)</span> 上的学生一定和 <span class="math notranslate nohighlight">\((x,y)\)</span> 上的学生共线并且位置离C君更近，所以 <span class="math notranslate nohighlight">\((x,y)\)</span> 上的学生一定会被挡。</p>
<div class="admonition- admonition">
<p class="admonition-title">结论</p>
<p>位置 <span class="math notranslate nohighlight">\((x,y)\)</span> 上的学生会被C君看到的条件是 <span class="math notranslate nohighlight">\(x\)</span> 和 <span class="math notranslate nohighlight">\(y\)</span> 互质。</p>
</div>
<p>事实上，左起第二列和倒数第二行上的所有学生之所以都不会被遮挡，都能被C君看到的原因也就是因为它们的位置坐标里至少有一个为1，而1和任何正整数互质。</p>
<p>现在问题变为求出 <span class="math notranslate nohighlight">\((2\le x \le N-1,2\le y \le N-1)\)</span> 范围内所有整数对 <span class="math notranslate nohighlight">\((x,y)\)</span> 中互质对的个数。如果你已经学过了欧拉 <span class="math notranslate nohighlight">\(\varphi\)</span> 函数那么你肯定会想到用它来解决问题，但是直接用简单的欧拉函数求解速度会比较慢，估计会TLE（我没有试过），最好用欧拉线性筛或者埃筛来打欧拉函数表，时间复杂度可以达到接近 <span class="math notranslate nohighlight">\(O(n)\)</span> （其实我也没有试过，这只是理论上的结论）。</p>
<p>不过可能许多人还不会欧拉函数，或许学过但是不熟练。而且如果是在考场上，要正确无误地编出欧拉函数题解还是有困难的。所以这里我们不打算介绍使用欧拉函数的方法（本质原因还是因为我并没有试过），而是用一种比较容易理解也比较容易编程的动态规划方法，这种方法同样能达到接近 <span class="math notranslate nohighlight">\(O(n)\)</span> 的时间复杂度，效率非常之高。</p>
<p>既然决定不用欧拉函数，那么正面求解互质对数量就不太可能了，我们采用迂回策略。我们可以求出不互质的数对数量，然后从总量 <span class="math notranslate nohighlight">\((N-2)^2\)</span> 中减去它不就是互质对的数量了吗？这就很类似于数学里的反证法，有时候是一种非常行之有效的方法。</p>
<p>在整数区间 <span class="math notranslate nohighlight">\([2,N-1]\)</span> 中的所有整数，他们可能有的大于1的因数 <span class="math notranslate nohighlight">\(m\)</span> 当然也只能是在这个范围里，<span class="math notranslate nohighlight">\(m\in\{2,3,\dots,N-1\}\)</span>。所以我们可以枚举所有可能的因数 <span class="math notranslate nohighlight">\(m\)</span>，计算含有公因数 <span class="math notranslate nohighlight">\(m\)</span> 的不互质数对的数量（注意：可不是最大公因数哦，是指单纯的公因数）。比如具有公因数2的不互质数对就有 <span class="math notranslate nohighlight">\((2,2)\)</span>、<span class="math notranslate nohighlight">\((2,4)\)</span>、<span class="math notranslate nohighlight">\((4,2)\)</span>、<span class="math notranslate nohighlight">\((4,4)\)</span>、<span class="math notranslate nohighlight">\((2,6)\)</span>……它们的共同点就是两个坐标值都是2的倍数。因此我们可以用 <span class="math notranslate nohighlight">\((pm,qm)\)</span> 来表示具有公因数 <span class="math notranslate nohighlight">\(m\)</span> 的不互质数对，其中 <span class="math notranslate nohighlight">\((p,q\in\Bbb{Z}^+,pm \lt N, qm \lt N)\)</span>。当这些数对用来表示格点坐标时，我们也称它们为 <span class="math notranslate nohighlight">\(m\)</span> 的<strong>格点</strong>。</p>
<div class="admonition- admonition">
<p class="admonition-title">结论</p>
<p>在整数区间 <span class="math notranslate nohighlight">\([2,N-1]\)</span> 范围内，对于任意整数 <span class="math notranslate nohighlight">\(2\le m\le N-1\)</span>，它的格点数量为 <span class="math notranslate nohighlight">\(\left(\lfloor\frac{N-1}{m}\rfloor\right)^2\)</span>。</p>
</div>
<p>这是因为我们要求格点的坐标值 <span class="math notranslate nohighlight">\(m,2m,\dots,pm\)</span> 也都必须要在这个范围内，即要满足 <span class="math notranslate nohighlight">\(pm\le N-1\implies p=\lfloor\frac{N-1}{m}\rfloor\)</span>。</p>
<p>下面继续用前面那个例子来看一看在 <span class="math notranslate nohighlight">\(N=9\)</span> 时的格点分布情况，橙色的点表示从2到8的格点，一共7张图：</p>
<img alt="../_images/701_p2158.002.png" src="../_images/701_p2158.002.png" />
<p>但是如果我们把这些图叠起来一看就容易发现，有不少数的格点之间是有重叠的。例如在4个4的格点中，<span class="math notranslate nohighlight">\((8,8)\)</span> 又是8的格点，在4个3的格点中，<span class="math notranslate nohighlight">\((6,6)\)</span> 又是6的格点。</p>
<img alt="../_images/701_p2158.003.png" src="../_images/701_p2158.003.png" />
<p>所以我们在从总人数中减去从2到 <span class="math notranslate nohighlight">\(N-1\)</span> 的格点数时，势必要先做一道去除重复的工作，否则就减多了。去除的方法也很简单，我们用动态规划法从 <span class="math notranslate nohighlight">\(N-1\)</span> 到 <span class="math notranslate nohighlight">\(2\)</span> 的倒数顺序来陆续计算它们各自的格点数量。每计算好一个 <span class="math notranslate nohighlight">\(m\)</span> 的格点，我们就从 <span class="math notranslate nohighlight">\(2m\)</span> 开始在范围 <span class="math notranslate nohighlight">\([2m, N-1]\)</span> 之内去寻找并减掉 <span class="math notranslate nohighlight">\(m\)</span> 的倍数的格点数。因为这些倍数都更大，所以肯定已经在我们的动态规划过程中先行计算好了，动态规划过程一定会成功。</p>
<p>让我们仍以 <span class="math notranslate nohighlight">\(N=9\)</span> 为例，看看这个动态规划的过程是怎样的。我们用数组 <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">x[9]</span></code> 来表示动态规划表，用变量 <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">m</span></code> 从8到2的循环来计算 <code class="docutils literal notranslate"><span class="pre">x[m]</span></code> 的值，即m的格点中经过去重处理后的非互质对的数量，是最终要从总人数中减去的人数。</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 17%" />
<col style="width: 12%" />
<col style="width: 25%" />
<col style="width: 17%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">m</span></code> 的格点数</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">m</span></code> 的倍数</p></th>
<th class="head"><p>重复计算人数</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">x[m]</span></code></p></th>
<th class="head"><p>动态规划表 <code class="docutils literal notranslate"><span class="pre">x[2]..x[8]</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">8</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(8/8)*(8/8)=1</span></code></p></td>
<td><p>无</p></td>
<td><p>无</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">1]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">7</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(8/7)*(8/7)=1</span></code></p></td>
<td><p>无</p></td>
<td><p>无</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">1,</span> <span class="pre">1]</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">6</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(8/6)*(8/6)=1</span></code></p></td>
<td><p>无</p></td>
<td><p>无</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(8/5)*(8/5)=1</span></code></p></td>
<td><p>无</p></td>
<td><p>无</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[?,</span> <span class="pre">?,</span> <span class="pre">?,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(8/4)*(8/4)=4</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">8</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x[8]=1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">4-1=3</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[?,</span> <span class="pre">?,</span> <span class="pre">3,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(8/3)*(8/3)=4</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">6</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x[6]=1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">4-1=3</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[?,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(8/2)*(8/2)=16</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">8</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x[4]=3,</span> <span class="pre">x[6]=1,</span> <span class="pre">x[8]=1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">16-3-1-1=11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[11,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code></p></td>
</tr>
</tbody>
</table>
<p>这样一个动态规划过程构建完成后，我们用 <span class="math notranslate nohighlight">\((9-2)^2=49\)</span> 减去动态规划表中各项之和就得到了从 <span class="math notranslate nohighlight">\((2,2)\)</span> 到 <span class="math notranslate nohighlight">\((8,8)\)</span> 这个范围的方阵中可以被C君看到的学生数量。再加上左边2列和下面2行中已经知道的能被C君看到的 <span class="math notranslate nohighlight">\(2\times 9-1=17\)</span> 位学生，就得到了整个 <span class="math notranslate nohighlight">\(N=9\)</span> 的方阵中能被C君看到的总学生数 <span class="math notranslate nohighlight">\(17+49-(11+3+3+1+1+1+1)=45\)</span> 人。</p>
<div class="admonition- admonition">
<p class="admonition-title">结论</p>
<p>设输入的方阵规模为 <span class="math notranslate nohighlight">\(N\)</span>，按上述算法构建动态规划表 <span class="math notranslate nohighlight">\(\{x_2,\dots,x_{N-1}\}\)</span> 后即可得到结果，能被C君看到的学生数量为：</p>
<div class="math notranslate nohighlight">
\[2N-1+(N-2)^2-\sum_{i=2}^{N-1}x_i\]</div>
</div>
<p>按照上述算法，不难编写出下面的程序：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="c1">// cnt: 答案，C君能看到的学生人数</span>
	<span class="c1">// x[]: 动态规划表，从x[2]到x[n-1]项表示看不见的人数（非互质对数量）</span>
	<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">40000</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
	<span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;0</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">cnt</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">m</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">x</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">km</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="p">;</span> <span class="n">km</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">km</span> <span class="o">+=</span> <span class="n">m</span><span class="p">)</span>
			<span class="n">x</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">-=</span> <span class="n">x</span><span class="p">[</span><span class="n">km</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">m</span><span class="o">++</span><span class="p">)</span>
		<span class="n">cnt</span> <span class="o">-=</span> <span class="n">x</span><span class="p">[</span><span class="n">m</span><span class="p">];</span>

	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>提交后很快得到AC结果：</p>
<img alt="../_images/701_p2158.png" src="../_images/701_p2158.png" />
<p>看得出来这个算法运行得非常快，已经很接近 <span class="math notranslate nohighlight">\(O(n)\)</span> 的水平了。不知道用欧拉线性筛打欧拉函数表的算法会不会更快一些？有兴趣的话可以作为练习尝试一下。</p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../700_problems.html" title="8. 竞赛题精选精讲"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C++算法编程指南 0.1 文档</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../700_problems.html" ><span class="section-number">8. </span>竞赛题精选精讲</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2019, Libin.
      由 <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.0 创建。
    </div>
  </body>
</html>